# 🎯 AI-VAD 모델 학습 방법 가이드

이 가이드는 우리 데이터로 AI-VAD 모델을 학습하는 두 가지 방법을 설명합니다.

## 📋 목차
1. [방법 1: 파인튜닝 (Fine-tuning)](#방법-1-파인튜닝-fine-tuning)
2. [방법 2: 처음부터 학습 (Training from Scratch)](#방법-2-처음부터-학습-training-from-scratch)
3. [두 방법 비교](#두-방법-비교)
4. [사용법](#사용법)
5. [문제 해결](#문제-해결)

---

## 🎯 방법 1: 파인튜닝 (Fine-tuning)

### 📁 파일
- **스크립트**: `train_aivad_finetune.py`
- **실행 파일**: `run_finetune.bat`
- **결과 체크포인트**: `aivad_finetuned.ckpt`

### 🔍 개념
기존에 훈련된 AI-VAD 모델을 우리 데이터에 맞게 미세 조정하는 방법입니다.

### ✅ 장점
- **빠른 학습**: 기존 가중치를 활용하여 학습 시간 단축
- **안정성**: 사전 훈련된 특징으로 안정적인 수렴
- **효율성**: 적은 데이터로도 효과적인 성능 향상
- **메모리 효율**: 상대적으로 적은 GPU 메모리 사용

### ❌ 단점
- **편향**: 기존 데이터셋의 편향에 영향받을 수 있음
- **제한**: 도메인 차이가 크면 성능 향상에 한계
- **의존성**: 사전 훈련된 모델에 의존

### ⚙️ 설정
```python
# 파인튜닝 설정
learning_rate = 1e-5      # 낮은 학습률
max_epochs = 5            # 적은 에포크
accumulate_grad_batches = 2
```

### 🎯 적합한 경우
- 빠른 프로토타이핑이 필요한 경우
- 데이터가 상대적으로 적은 경우
- 기존 도메인과 유사한 데이터인 경우
- 안정적인 결과를 원하는 경우

---

## 🎯 방법 2: 처음부터 학습 (Training from Scratch)

### 📁 파일
- **스크립트**: `train_aivad_from_scratch.py`
- **실행 파일**: `run_from_scratch.bat`
- **결과 체크포인트**: `aivad_from_scratch.ckpt`

### 🔍 개념
우리 데이터로 처음부터 AI-VAD 모델을 완전히 새로 학습하는 방법입니다.

### ✅ 장점
- **도메인 특화**: 우리 데이터에 완전히 최적화
- **자유도**: 모든 하이퍼파라미터를 자유롭게 조정
- **편향 없음**: 기존 데이터셋의 편향에 영향받지 않음
- **최적 성능**: 충분한 데이터와 시간이 있다면 최고 성능

### ❌ 단점
- **시간**: 긴 학습 시간 필요
- **자원**: 많은 GPU 메모리와 계산 자원 필요
- **데이터**: 충분한 양의 고품질 데이터 필요
- **안정성**: 수렴이 불안정할 수 있음

### ⚙️ 설정
```python
# 처음부터 학습 설정
learning_rate = 1e-4      # 높은 학습률
max_epochs = 20           # 많은 에포크
accumulate_grad_batches = 4
```

### 🎯 적합한 경우
- 충분한 데이터가 있는 경우
- 완전한 커스터마이징이 필요한 경우
- 도메인이 매우 특수한 경우
- 최고 성능을 원하는 경우

---

## 📊 두 방법 비교

| 특성 | 파인튜닝 | 처음부터 학습 |
|------|----------|---------------|
| **학습 시간** | ⭐⭐⭐⭐⭐ 빠름 | ⭐⭐ 느림 |
| **GPU 메모리** | ⭐⭐⭐⭐ 적음 | ⭐⭐ 많음 |
| **데이터 요구량** | ⭐⭐⭐⭐ 적음 | ⭐⭐ 많음 |
| **성능 잠재력** | ⭐⭐⭐ 좋음 | ⭐⭐⭐⭐⭐ 최고 |
| **안정성** | ⭐⭐⭐⭐⭐ 높음 | ⭐⭐⭐ 보통 |
| **커스터마이징** | ⭐⭐⭐ 보통 | ⭐⭐⭐⭐⭐ 완전 |
| **도메인 적응** | ⭐⭐⭐ 보통 | ⭐⭐⭐⭐⭐ 완전 |

---

## 🚀 사용법

### 1️⃣ 사전 준비
```bash
# 1. 비디오 파일 경로 설정
# video_files_list.py 파일에서 video_files 리스트 수정

# 2. 필요한 체크포인트 확인
# 파인튜닝의 경우: aivad_proper_checkpoint.ckpt 필요
```

### 2️⃣ 파인튜닝 실행
```bash
# Windows에서
run_finetune.bat

# 또는 직접 실행
python train_aivad_finetune.py
```

### 3️⃣ 처음부터 학습 실행
```bash
# Windows에서
run_from_scratch.bat

# 또는 직접 실행
python train_aivad_from_scratch.py
```

### 4️⃣ 결과 확인
```bash
# 생성된 체크포인트 파일 확인
# - aivad_finetuned.ckpt (파인튜닝)
# - aivad_from_scratch.ckpt (처음부터 학습)
```

### 5️⃣ UI에서 테스트
```bash
# realtime_ui_advanced_windows.py 실행
# 체크포인트 로드하여 성능 테스트
```

---

## 🔧 설정 커스터마이징

### 학습률 조정
```python
# 파인튜닝용 (더 보수적)
learning_rate = 1e-6  # 더 낮게

# 처음부터 학습용 (더 공격적)
learning_rate = 1e-3  # 더 높게
```

### 에포크 수 조정
```python
# 파인튜닝용
max_epochs = 10  # 더 많이

# 처음부터 학습용
max_epochs = 50  # 훨씬 더 많이
```

### 배치 크기 조정
```python
# GPU 메모리에 따라 조정
batch_size = 1   # 메모리 부족시
batch_size = 4   # 일반적
batch_size = 8   # 메모리 충분시
```

---

## 🚨 문제 해결

### GPU 메모리 부족
```python
# 배치 크기 줄이기
batch_size = 1

# 그래디언트 누적 늘리기
accumulate_grad_batches = 8

# 정밀도 낮추기
precision = "16-mixed"
```

### 학습 속도가 느림
```python
# 워커 수 늘리기
num_workers = 4

# 배치 크기 늘리기 (메모리 허용시)
batch_size = 4
```

### 수렴이 안됨
```python
# 학습률 낮추기
learning_rate = 1e-6

# 그래디언트 클리핑 강화
gradient_clip_val = 0.5
```

### 데이터 로딩 오류
```python
# 비디오 파일 경로 확인
# video_files_list.py의 경로가 올바른지 확인

# 비디오 형식 확인
# MP4, AVI 등 지원 형식인지 확인
```

---

## 💡 권장사항

### 🥇 첫 번째 시도
1. **파인튜닝**으로 시작
2. 빠른 결과 확인
3. 성능이 만족스럽지 않으면 처음부터 학습

### 🥈 최적화 과정
1. **파인튜닝**으로 베이스라인 설정
2. **처음부터 학습**으로 성능 향상
3. 하이퍼파라미터 튜닝

### 🥉 프로덕션 배포
1. **처음부터 학습**된 모델 사용
2. 충분한 검증 데이터로 테스트
3. 실제 환경에서 성능 모니터링

---

## 📞 지원

문제가 발생하면 다음을 확인하세요:

1. **로그 파일**: 실행 중 생성되는 오류 메시지
2. **GPU 상태**: `nvidia-smi`로 GPU 메모리 확인
3. **데이터 경로**: `video_files_list.py`의 파일 경로
4. **환경 설정**: conda 환경과 패키지 버전

**Happy Training! 🚀**
