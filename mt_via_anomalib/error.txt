PACKAGE LIST
(mt_p310) PS C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib> pip list
Package                Version
---------------------- -----------
aiofiles               24.1.0
aiohappyeyeballs       2.6.1
aiohttp                3.13.0
aiosignal              1.4.0
annotated-types        0.7.0
anomalib               2.2.0
antlr4-python3-runtime 4.9.3
anyio                  4.11.0
async-timeout          5.0.1
attrs                  25.4.0
av                     16.0.1
Brotli                 1.1.0
certifi                2025.10.5
charset-normalizer     3.4.3
click                  8.3.0
clip                   1.0
colorama               0.4.6
contourpy              1.3.2
cycler                 0.12.1
docstring_parser       0.17.0
einops                 0.8.1
exceptiongroup         1.3.0
faiss-cpu              1.12.0
fastapi                0.119.0
ffmpy                  0.6.3
filelock               3.20.0
fonttools              4.60.1
FrEIA                  0.2
frozenlist             1.8.0
fsspec                 2025.9.0
ftfy                   6.3.1
gradio                 5.49.1
gradio_client          1.13.3
groovy                 0.1.2
h11                    0.16.0
httpcore               1.0.9
httpx                  0.28.1
huggingface-hub        0.35.3
idna                   3.11
imagecodecs            2025.3.30
imageio                2.37.0
importlib_resources    6.5.2
Jinja2                 3.1.6
joblib                 1.5.2
jsonargparse           4.41.0
kiwisolver             1.4.9
kornia                 0.8.1
kornia_rs              0.1.9
lazy_loader            0.4
lightning              2.5.5
lightning-utilities    0.15.2
markdown-it-py         4.0.0
MarkupSafe             3.0.3
matplotlib             3.10.7
mdurl                  0.1.2
mpmath                 1.3.0
multidict              6.7.0
narwhals               2.8.0
networkx               3.4.2
numpy                  2.2.6
omegaconf              2.3.0
opencv-contrib-python  4.12.0.88
opencv-python          4.12.0.88
orjson                 3.11.3
packaging              25.0
pandas                 2.3.3
pillow                 11.3.0
pip                    25.2
plotly                 6.3.1
propcache              0.4.1
pydantic               2.11.10
pydantic_core          2.33.2
pydub                  0.25.1
Pygments               2.19.2
pyparsing              3.2.5
PySide6                6.10.0
PySide6_Addons         6.10.0
PySide6_Essentials     6.10.0
python-dateutil        2.9.0.post0
python-multipart       0.0.20
pytorch-lightning      2.5.5
pytz                   2025.2
PyYAML                 6.0.3
regex                  2025.9.18
requests               2.32.5
rich                   14.2.0
rich-argparse          1.7.1
ruff                   0.14.0
safehttpx              0.1.6
safetensors            0.6.2
scikit-image           0.25.2
scikit-learn           1.7.2
scipy                  1.15.3
semantic-version       2.10.0
setuptools             80.9.0
shellingham            1.5.4
shiboken6              6.10.0
six                    1.17.0
sniffio                1.3.1
starlette              0.48.0
sympy                  1.14.0
threadpoolctl          3.6.0
tifffile               2025.5.10
timm                   1.0.20
tomlkit                0.13.3
torch                  2.8.0
torchaudio             2.8.0
torchmetrics           1.8.2
torchvision            0.23.0
tqdm                   4.67.1
typer                  0.19.2
typeshed_client        2.8.2
typing_extensions      4.15.0
typing-inspection      0.4.2
tzdata                 2025.2
urllib3                2.5.0
uvicorn                0.37.0
wcwidth                0.2.14
websockets             15.0.1
wheel                  0.45.1
yarl                   1.22.0
(mt_p310) PS C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib> conda list
# packages in environment at C:\Users\User\anaconda3\envs\mt_p310:
#
# Name                    Version                   Build  Channel
aiofiles                  24.1.0                   pypi_0    pypi
aiohappyeyeballs          2.6.1                    pypi_0    pypi
aiohttp                   3.13.0                   pypi_0    pypi
aiosignal                 1.4.0                    pypi_0    pypi
annotated-types           0.7.0                    pypi_0    pypi
anomalib                  2.2.0                    pypi_0    pypi
antlr4-python3-runtime    4.9.3                    pypi_0    pypi
anyio                     4.11.0                   pypi_0    pypi
async-timeout             5.0.1                    pypi_0    pypi
attrs                     25.4.0                   pypi_0    pypi
av                        16.0.1                   pypi_0    pypi
brotli                    1.1.0                    pypi_0    pypi
bzip2                     1.0.8                h2bbff1b_6
ca-certificates           2025.9.9             haa95532_0
certifi                   2025.10.5                pypi_0    pypi
charset-normalizer        3.4.3                    pypi_0    pypi
click                     8.3.0                    pypi_0    pypi
clip                      1.0                      pypi_0    pypi
colorama                  0.4.6                    pypi_0    pypi
contourpy                 1.3.2                    pypi_0    pypi
cycler                    0.12.1                   pypi_0    pypi
docstring-parser          0.17.0                   pypi_0    pypi
einops                    0.8.1                    pypi_0    pypi
exceptiongroup            1.3.0                    pypi_0    pypi
expat                     2.7.1                h8ddb27b_0
faiss-cpu                 1.12.0                   pypi_0    pypi
fastapi                   0.119.0                  pypi_0    pypi
ffmpy                     0.6.3                    pypi_0    pypi
filelock                  3.20.0                   pypi_0    pypi
fonttools                 4.60.1                   pypi_0    pypi
freia                     0.2                      pypi_0    pypi
frozenlist                1.8.0                    pypi_0    pypi
fsspec                    2025.9.0                 pypi_0    pypi
ftfy                      6.3.1                    pypi_0    pypi
gradio                    5.49.1                   pypi_0    pypi
gradio-client             1.13.3                   pypi_0    pypi
groovy                    0.1.2                    pypi_0    pypi
h11                       0.16.0                   pypi_0    pypi
httpcore                  1.0.9                    pypi_0    pypi
httpx                     0.28.1                   pypi_0    pypi
huggingface-hub           0.35.3                   pypi_0    pypi
idna                      3.11                     pypi_0    pypi
imagecodecs               2025.3.30                pypi_0    pypi
imageio                   2.37.0                   pypi_0    pypi
importlib-resources       6.5.2                    pypi_0    pypi
jinja2                    3.1.6                    pypi_0    pypi
joblib                    1.5.2                    pypi_0    pypi
jsonargparse              4.41.0                   pypi_0    pypi
kiwisolver                1.4.9                    pypi_0    pypi
kornia                    0.8.1                    pypi_0    pypi
kornia-rs                 0.1.9                    pypi_0    pypi
lazy-loader               0.4                      pypi_0    pypi
libffi                    3.4.4                hd77b12b_1
libzlib                   1.3.1                h02ab6af_0
lightning                 2.5.5                    pypi_0    pypi
lightning-utilities       0.15.2                   pypi_0    pypi
markdown-it-py            4.0.0                    pypi_0    pypi
markupsafe                3.0.3                    pypi_0    pypi
matplotlib                3.10.7                   pypi_0    pypi
mdurl                     0.1.2                    pypi_0    pypi
mpmath                    1.3.0                    pypi_0    pypi
multidict                 6.7.0                    pypi_0    pypi
narwhals                  2.8.0                    pypi_0    pypi
networkx                  3.4.2                    pypi_0    pypi
numpy                     2.2.6                    pypi_0    pypi
omegaconf                 2.3.0                    pypi_0    pypi
opencv-contrib-python     4.12.0.88                pypi_0    pypi
opencv-python             4.12.0.88                pypi_0    pypi
openssl                   3.0.18               h543e019_0
orjson                    3.11.3                   pypi_0    pypi
packaging                 25.0                     pypi_0    pypi
pandas                    2.3.3                    pypi_0    pypi
pillow                    11.3.0                   pypi_0    pypi
pip                       25.2               pyhc872135_0
plotly                    6.3.1                    pypi_0    pypi
propcache                 0.4.1                    pypi_0    pypi
pydantic                  2.11.10                  pypi_0    pypi
pydantic-core             2.33.2                   pypi_0    pypi
pydub                     0.25.1                   pypi_0    pypi
pygments                  2.19.2                   pypi_0    pypi
pyparsing                 3.2.5                    pypi_0    pypi
pyside6                   6.10.0                   pypi_0    pypi
pyside6-addons            6.10.0                   pypi_0    pypi
pyside6-essentials        6.10.0                   pypi_0    pypi
python                    3.10.18              h981015d_0
python-dateutil           2.9.0.post0              pypi_0    pypi
python-multipart          0.0.20                   pypi_0    pypi
pytorch-lightning         2.5.5                    pypi_0    pypi
pytz                      2025.2                   pypi_0    pypi
pyyaml                    6.0.3                    pypi_0    pypi
regex                     2025.9.18                pypi_0    pypi
requests                  2.32.5                   pypi_0    pypi
rich                      14.2.0                   pypi_0    pypi
rich-argparse             1.7.1                    pypi_0    pypi
ruff                      0.14.0                   pypi_0    pypi
safehttpx                 0.1.6                    pypi_0    pypi
safetensors               0.6.2                    pypi_0    pypi
scikit-image              0.25.2                   pypi_0    pypi
scikit-learn              1.7.2                    pypi_0    pypi
scipy                     1.15.3                   pypi_0    pypi
semantic-version          2.10.0                   pypi_0    pypi
setuptools                80.9.0          py310haa95532_0
shellingham               1.5.4                    pypi_0    pypi
shiboken6                 6.10.0                   pypi_0    pypi
six                       1.17.0                   pypi_0    pypi
sniffio                   1.3.1                    pypi_0    pypi
sqlite                    3.50.2               hda9a48d_1
starlette                 0.48.0                   pypi_0    pypi
sympy                     1.14.0                   pypi_0    pypi
threadpoolctl             3.6.0                    pypi_0    pypi
tifffile                  2025.5.10                pypi_0    pypi
timm                      1.0.20                   pypi_0    pypi
tk                        8.6.15               hf199647_0
tomlkit                   0.13.3                   pypi_0    pypi
torch                     2.8.0                    pypi_0    pypi
torchaudio                2.8.0                    pypi_0    pypi
torchmetrics              1.8.2                    pypi_0    pypi
torchvision               0.23.0                   pypi_0    pypi
tqdm                      4.67.1                   pypi_0    pypi
typer                     0.19.2                   pypi_0    pypi
typeshed-client           2.8.2                    pypi_0    pypi
typing-extensions         4.15.0                   pypi_0    pypi
typing-inspection         0.4.2                    pypi_0    pypi
tzdata                    2025.2                   pypi_0    pypi
ucrt                      10.0.22621.0         haa95532_0
urllib3                   2.5.0                    pypi_0    pypi
uvicorn                   0.37.0                   pypi_0    pypi
vc                        14.3                h2df5915_10
vc14_runtime              14.44.35208         h4927774_10
vs2015_runtime            14.44.35208         ha6b5a95_10
wcwidth                   0.2.14                   pypi_0    pypi
websockets                15.0.1                   pypi_0    pypi
wheel                     0.45.1          py310haa95532_0
xz                        5.6.4                h4754444_1
yarl                      1.22.0                   pypi_0    pypi
zlib                      1.3.1                h02ab6af_0


""ERROR LOGS""
(mt_p310) C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib>python train_custom_ultimate.py
============================================================
ğŸ† ê¶ê·¹ì˜ ì•ˆì • ë²„ì „ - ì»¤ìŠ¤í…€ ë¹„ë””ì˜¤ ë°ì´í„°ì…‹ìœ¼ë¡œ AI-VAD í•™ìŠµ
============================================================
ğŸš€ ì»¤ìŠ¤í…€ ë¹„ë””ì˜¤ ë°ì´í„°ì…‹ìœ¼ë¡œ AI-VAD ëª¨ë¸ í•™ìŠµ ì‹œì‘ (ê¶ê·¹ì˜ ì•ˆì • ë²„ì „)...
ğŸ“ ì»¤ìŠ¤í…€ Avenue í˜•ì‹ ë°ì´í„°ì…‹ ì¤€ë¹„ ì¤‘...
âœ… ê¸°ì¡´ ë°ì´í„°ì…‹ ì •ë¦¬ ì™„ë£Œ
âœ… ë³µì‚¬ ì™„ë£Œ: normal_video.mp4 -> 01.avi
âœ… ë³µì‚¬ ì™„ë£Œ: unknown_video.mp4 -> 02.avi
ğŸ“ í…ŒìŠ¤íŠ¸ìš© ë¹„ë””ì˜¤ ë³µì‚¬ ì¤‘...
âœ… í…ŒìŠ¤íŠ¸ ë³µì‚¬: 01.avi
âœ… í…ŒìŠ¤íŠ¸ ë³µì‚¬: 02.avi
ğŸ“ Avenue ground truth êµ¬ì¡° ìƒì„± ì¤‘...
âœ… Ground truth ìƒì„±: 1_label (100ê°œ ë§ˆìŠ¤í¬)
âœ… Ground truth ìƒì„±: 2_label (100ê°œ ë§ˆìŠ¤í¬)
âœ… Avenue ground truth êµ¬ì¡° ìƒì„± ì™„ë£Œ
âœ… Avenue í˜•ì‹ ë°ì´í„°ì…‹ ì¤€ë¹„ ì™„ë£Œ: 2ê°œ íŒŒì¼ ì²˜ë¦¬ë¨
CPU ì‚¬ìš©
ğŸ“ ë°ì´í„°ì…‹ ë¡œë“œ ì¤‘...
ğŸ“‚ ë°ì´í„°ì…‹ ê²½ë¡œ: C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib\custom_avenue_ultimate
ğŸ“‚ Ground truth ê²½ë¡œ: C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib\custom_avenue_ultimate\ground_truth_demo
âœ… ë°ì´í„°ì…‹ ë¡œë“œ ì™„ë£Œ
ğŸ¤– AI-VAD ëª¨ë¸ ì´ˆê¸°í™”...
âœ… ëª¨ë¸ ì´ˆê¸°í™” ì™„ë£Œ
âš™ï¸  í•™ìŠµ ì—”ì§„ ì„¤ì •...
âœ… í•™ìŠµ ì—”ì§„ ì„¤ì • ì™„ë£Œ
ğŸ¯ í•™ìŠµ ì‹œì‘!
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
`Trainer(val_check_interval=1.0)` was configured so validation will run at the end of the training epoch..
  0%|                                                                                            | 0/1 [00:00<?, ?it/s]C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torchvision\io\_video_deprecation_warning.py:5: UserWarning: The video decoding and encoding capabilities of torchvision are deprecated from version 0.22 and will be removed in version 0.24. We recommend that you migrate to TorchCodec, where we'll consolidate the future decoding/encoding capabilities of PyTorch: https://github.com/pytorch/torchcodec
  warnings.warn(
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  3.95it/s]
  0%|                                                                                            | 0/1 [00:00<?, ?it/s]C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torchvision\io\_video_deprecation_warning.py:5: UserWarning: The video decoding and encoding capabilities of torchvision are deprecated from version 0.22 and will be removed in version 0.24. We recommend that you migrate to TorchCodec, where we'll consolidate the future decoding/encoding capabilities of PyTorch: https://github.com/pytorch/torchcodec
  warnings.warn(
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  4.67it/s]
C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\core\optimizer.py:183: `LightningModule.configure_optimizers` returned `None`, this fit will run with no optimizer

  | Name           | Type          | Params | Mode
---------------------------------------------------------
0 | pre_processor  | PreProcessor  | 0      | train
1 | post_processor | PostProcessor | 0      | train
2 | evaluator      | Evaluator     | 0      | train
3 | model          | AiVadModel    | 260 M  | train
---------------------------------------------------------
259 M     Trainable params
447 K     Non-trainable params
260 M     Total params
1,041.500 Total estimated model params size (MB)
670       Modules in train mode
227       Modules in eval mode
C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\connectors\data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\connectors\data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\fit_loop.py:527: Found 227 module(s) in eval mode at the start of training. This may lead to unexpected behavior during training. If this is intentional, you can ignore this warning.
Epoch 0:  20%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                           | 2/10 [00:31<02:04,  0.06it/Epoch 0:  20%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                       | 2/10 [36:26<2:25:45,  0.00it/s] Epoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [38:21<00:00,  0.00it/s] âŒ í•™ìŠµ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: Caught IndexError in DataLoader worker process 0.                       | 0/? [00:00<?, ?it/s]
Original Traceback (most recent call last):
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\base\video.py", line 207, in __getitem__
    item = self.indexer.get_item(index)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\utils\video.py", line 132, in get_item
    gt_mask=self.get_mask(idx),
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\video\avenue.py", line 203, in get_mask
    mask_paths = [mask_frames[idx] for idx in frames.int()]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\video\avenue.py", line 203, in <listcomp>
    mask_paths = [mask_frames[idx] for idx in frames.int()]
IndexError: list index out of range

Traceback (most recent call last):
  File "C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib\train_custom_ultimate.py", line 285, in main
    engine.fit(model=model, datamodule=datamodule)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\engine\engine.py", line 412, in fit
    self.trainer.fit(model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 560, in fit
    call._call_and_handle_interrupt(
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\call.py", line 49, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 598, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 1011, in _run
    results = self._run_stage()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 1055, in _run_stage
    self.fit_loop.run()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\fit_loop.py", line 216, in run
    self.advance()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\fit_loop.py", line 458, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\training_epoch_loop.py", line 153, in run
    self.on_advance_end(data_fetcher)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\training_epoch_loop.py", line 398, in on_advance_end
    self.val_loop.run()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\evaluation_loop.py", line 138, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\fetchers.py", line 134, in __next__
    batch = super().__next__()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\fetchers.py", line 61, in __next__
    batch = next(self.iterator)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\utilities\combined_loader.py", line 341, in __next__
    out = next(self._iterator)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\utilities\combined_loader.py", line 142, in __next__
    out = next(self.iterators[0])
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\dataloader.py", line 734, in __next__
    data = self._next_data()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\dataloader.py", line 1516, in _next_data
    return self._process_data(data, worker_id)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\dataloader.py", line 1551, in _process_data
    data.reraise()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\_utils.py", line 769, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\base\video.py", line 207, in __getitem__
    item = self.indexer.get_item(index)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\utils\video.py", line 132, in get_item
    gt_mask=self.get_mask(idx),
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\video\avenue.py", line 203, in get_mask
    mask_paths = [mask_frames[idx] for idx in frames.int()]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\video\avenue.py", line 203, in <listcomp>
    mask_paths = [mask_frames[idx] for idx in frames.int()]
IndexError: list index out of range


ğŸ’¥ í•™ìŠµì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.

ğŸ“‹ í•´ê²° ë°©ë²•:
1. video_files ë¦¬ìŠ¤íŠ¸ì— ì˜¬ë°”ë¥¸ ë¹„ë””ì˜¤ íŒŒì¼ ê²½ë¡œë¥¼ ì¶”ê°€í•˜ì„¸ìš”
2. ë¹„ë””ì˜¤ íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
3. ì§€ì›ë˜ëŠ” í˜•ì‹ì¸ì§€ í™•ì¸í•˜ì„¸ìš” (.mp4, .avi, .mov, .mkv, .flv, .wmv)
4. ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•˜ì„¸ìš”
Epoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [38:31<00:00,  0.00it/s]

(mt_p310) C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib>


---- 2025.10.15. 19:19 ---

(mt_p310) C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib>python train_custom_ultimate.py
============================================================
ğŸ† ê¶ê·¹ì˜ ì•ˆì • ë²„ì „ - ì»¤ìŠ¤í…€ ë¹„ë””ì˜¤ ë°ì´í„°ì…‹ìœ¼ë¡œ AI-VAD í•™ìŠµ
============================================================
ğŸš€ ì»¤ìŠ¤í…€ ë¹„ë””ì˜¤ ë°ì´í„°ì…‹ìœ¼ë¡œ AI-VAD ëª¨ë¸ í•™ìŠµ ì‹œì‘ (ê¶ê·¹ì˜ ì•ˆì • ë²„ì „)...
ğŸ“ ì»¤ìŠ¤í…€ Avenue í˜•ì‹ ë°ì´í„°ì…‹ ì¤€ë¹„ ì¤‘...
âœ… ê¸°ì¡´ ë°ì´í„°ì…‹ ì •ë¦¬ ì™„ë£Œ
âœ… ë³µì‚¬ ì™„ë£Œ: normal_video.mp4 -> 01.avi
âœ… ë³µì‚¬ ì™„ë£Œ: unknown_video.mp4 -> 02.avi
ğŸ“ í…ŒìŠ¤íŠ¸ìš© ë¹„ë””ì˜¤ ë³µì‚¬ ì¤‘...
âœ… í…ŒìŠ¤íŠ¸ ë³µì‚¬: 01.avi
âœ… í…ŒìŠ¤íŠ¸ ë³µì‚¬: 02.avi
ğŸ“ Avenue ground truth êµ¬ì¡° ìƒì„± ì¤‘...
âœ… Ground truth ìƒì„±: 1_label (100ê°œ ë§ˆìŠ¤í¬)
âœ… Ground truth ìƒì„±: 2_label (100ê°œ ë§ˆìŠ¤í¬)
âœ… Avenue ground truth êµ¬ì¡° ìƒì„± ì™„ë£Œ
âœ… Avenue í˜•ì‹ ë°ì´í„°ì…‹ ì¤€ë¹„ ì™„ë£Œ: 2ê°œ íŒŒì¼ ì²˜ë¦¬ë¨
GPU ì‚¬ìš©: NVIDIA GeForce RTX 4090
GPU ë©”ëª¨ë¦¬: 24.0 GB
ğŸ“ ë°ì´í„°ì…‹ ë¡œë“œ ì¤‘...
ğŸ“‚ ë°ì´í„°ì…‹ ê²½ë¡œ: C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib\custom_avenue_ultimate
ğŸ“‚ Ground truth ê²½ë¡œ: C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib\custom_avenue_ultimate\ground_truth_demo
âœ… ë°ì´í„°ì…‹ ë¡œë“œ ì™„ë£Œ
ğŸ¤– AI-VAD ëª¨ë¸ ì´ˆê¸°í™”...
âœ… ëª¨ë¸ ì´ˆê¸°í™” ì™„ë£Œ
âš™ï¸  í•™ìŠµ ì—”ì§„ ì„¤ì •...
âœ… í•™ìŠµ ì—”ì§„ ì„¤ì • ì™„ë£Œ
ğŸ¯ í•™ìŠµ ì‹œì‘!
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
`Trainer(val_check_interval=1.0)` was configured so validation will run at the end of the training epoch..
You are using a CUDA device ('NVIDIA GeForce RTX 4090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
  0%|                                                                                         | 0/1 [00:00<?, ?it/s]C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torchvision\io\_video_deprecation_warning.py:5: UserWarning: The video decoding and encoding capabilities of torchvision are deprecated from version 0.22 and will be removed in version 0.24. We recommend that you migrate to TorchCodec, where we'll consolidate the future decoding/encoding capabilities of PyTorch: https://github.com/pytorch/torchcodec
  warnings.warn(
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  4.54it/s]
  0%|                                                                                         | 0/1 [00:00<?, ?it/s]C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torchvision\io\_video_deprecation_warning.py:5: UserWarning: The video decoding and encoding capabilities of torchvision are deprecated from version 0.22 and will be removed in version 0.24. We recommend that you migrate to TorchCodec, where we'll consolidate the future decoding/encoding capabilities of PyTorch: https://github.com/pytorch/torchcodec
  warnings.warn(
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  5.28it/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\core\optimizer.py:183: `LightningModule.configure_optimizers` returned `None`, this fit will run with no optimizer

  | Name           | Type          | Params | Mode
---------------------------------------------------------
0 | pre_processor  | PreProcessor  | 0      | train
1 | post_processor | PostProcessor | 0      | train
2 | evaluator      | Evaluator     | 0      | train
3 | model          | AiVadModel    | 260 M  | train
---------------------------------------------------------
259 M     Trainable params
447 K     Non-trainable params
260 M     Total params
1,041.500 Total estimated model params size (MB)
670       Modules in train mode
227       Modules in eval mode
C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\connectors\data_connector.py:428: Consider setting `persistent_workers=True` in 'train_dataloader' to speed up the dataloader worker initialization.
C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\connectors\data_connector.py:428: Consider setting `persistent_workers=True` in 'val_dataloader' to speed up the dataloader worker initialization.
C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\fit_loop.py:527: Found 227 module(s) in eval mode at the start of training. This may lead to unexpected behavior during training. If this is intentional, you can ignore this warning.
Epoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:10<00:00,  0.92it/s] âŒ í•™ìŠµ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: Caught IndexError in DataLoader worker process 0.                       | 0/? [00:00<?, ?it/s]
Original Traceback (most recent call last):
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\base\video.py", line 207, in __getitem__
    item = self.indexer.get_item(index)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\utils\video.py", line 132, in get_item
    gt_mask=self.get_mask(idx),
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\video\avenue.py", line 203, in get_mask
    mask_paths = [mask_frames[idx] for idx in frames.int()]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\video\avenue.py", line 203, in <listcomp>
    mask_paths = [mask_frames[idx] for idx in frames.int()]
IndexError: list index out of range

Traceback (most recent call last):
  File "C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib\train_custom_ultimate.py", line 285, in main
    engine.fit(model=model, datamodule=datamodule)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\engine\engine.py", line 412, in fit
    self.trainer.fit(model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 560, in fit
    call._call_and_handle_interrupt(
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\call.py", line 49, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 598, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 1011, in _run
    results = self._run_stage()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\trainer\trainer.py", line 1055, in _run_stage
    self.fit_loop.run()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\fit_loop.py", line 216, in run
    self.advance()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\fit_loop.py", line 458, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\training_epoch_loop.py", line 153, in run
    self.on_advance_end(data_fetcher)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\training_epoch_loop.py", line 398, in on_advance_end
    self.val_loop.run()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\evaluation_loop.py", line 138, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\fetchers.py", line 134, in __next__
    batch = super().__next__()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\loops\fetchers.py", line 61, in __next__
    batch = next(self.iterator)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\utilities\combined_loader.py", line 341, in __next__
    out = next(self._iterator)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\lightning\pytorch\utilities\combined_loader.py", line 142, in __next__
    out = next(self.iterators[0])
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\dataloader.py", line 733, in __next__
    data = self._next_data()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\dataloader.py", line 1515, in _next_data
    return self._process_data(data, worker_id)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\dataloader.py", line 1550, in _process_data
    data.reraise()
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\_utils.py", line 750, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\base\video.py", line 207, in __getitem__
    item = self.indexer.get_item(index)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\utils\video.py", line 132, in get_item
    gt_mask=self.get_mask(idx),
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\video\avenue.py", line 203, in get_mask
    mask_paths = [mask_frames[idx] for idx in frames.int()]
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\data\datasets\video\avenue.py", line 203, in <listcomp>
    mask_paths = [mask_frames[idx] for idx in frames.int()]
IndexError: list index out of range


ğŸ’¥ í•™ìŠµì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.

ğŸ“‹ í•´ê²° ë°©ë²•:
1. video_files ë¦¬ìŠ¤íŠ¸ì— ì˜¬ë°”ë¥¸ ë¹„ë””ì˜¤ íŒŒì¼ ê²½ë¡œë¥¼ ì¶”ê°€í•˜ì„¸ìš”
2. ë¹„ë””ì˜¤ íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
3. ì§€ì›ë˜ëŠ” í˜•ì‹ì¸ì§€ í™•ì¸í•˜ì„¸ìš” (.mp4, .avi, .mov, .mkv, .flv, .wmv)
4. ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•˜ì„¸ìš”
Epoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:21<00:00,  0.47it/s]

--- ISSUE 1 : no gpu memory allocated ---
(mt_p310) C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib>python train_custom_final_fixed.py
ğŸ”§ GPU ë° cuDNN ì„¤ì • ìµœì í™” ì¤‘...
âœ… GPU ì‚¬ìš© ê°€ëŠ¥: NVIDIA GeForce RTX 4090
âœ… GPU ë©”ëª¨ë¦¬: 24.0 GB
============================================================
ğŸ† ìµœì¢… ì™„ë²½ ìˆ˜ì • ë²„ì „ - ì»¤ìŠ¤í…€ ë¹„ë””ì˜¤ ë°ì´í„°ì…‹ìœ¼ë¡œ AI-VAD í•™ìŠµ
============================================================
ğŸš€ ì»¤ìŠ¤í…€ ë¹„ë””ì˜¤ ë°ì´í„°ì…‹ìœ¼ë¡œ AI-VAD ëª¨ë¸ í•™ìŠµ ì‹œì‘ (ìµœì¢… ì™„ë²½ ìˆ˜ì • ë²„ì „)...
âœ… video_files_listì—ì„œ 20ê°œ ë¹„ë””ì˜¤ íŒŒì¼ ë¡œë“œ
ğŸ” GPU ìƒíƒœ ì§„ë‹¨ ì¤‘...
CUDA ê°€ìš©ì„±: True
GPU ê°œìˆ˜: 2
GPU 0: NVIDIA GeForce RTX 4090 (24.0 GB)
GPU 1: NVIDIA GeForce RTX 4090 (24.0 GB)
âœ… GPU ì‚¬ìš© ì„¤ì •: NVIDIA GeForce RTX 4090
GPU ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: 0.0 GB (í• ë‹¹ë¨), 0.0 GB (ìºì‹œë¨)
ğŸ“ ê°„ë‹¨í•œ ë¹„ë””ì˜¤ ë°ì´í„°ì…‹ ì¤€ë¹„ ì¤‘...
ğŸ“ ê°„ë‹¨í•œ ë°ì´í„°ë¡œë” ìƒì„± ì¤‘...
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_0.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_1.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_2.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_3.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_4.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_5.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_6.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_7.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_8.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_9.avi (1000 í”„ë ˆì„)


--- ISSUE 2 : tensor size ---

ğŸš€ ì»¤ìŠ¤í…€ ë¹„ë””ì˜¤ ë°ì´í„°ì…‹ìœ¼ë¡œ AI-VAD ëª¨ë¸ í•™ìŠµ ì‹œì‘ (ìµœì¢… ì™„ë²½ ìˆ˜ì • ë²„ì „)...
âœ… video_files_listì—ì„œ 20ê°œ ë¹„ë””ì˜¤ íŒŒì¼ ë¡œë“œ
ğŸ” GPU ìƒíƒœ ì§„ë‹¨ ì¤‘...
CUDA ê°€ìš©ì„±: True
GPU ê°œìˆ˜: 2
GPU 0: NVIDIA GeForce RTX 4090 (24.0 GB)
GPU 1: NVIDIA GeForce RTX 4090 (24.0 GB)
âœ… GPU ì‚¬ìš© ì„¤ì •: NVIDIA GeForce RTX 4090
GPU ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: 0.0 GB (í• ë‹¹ë¨), 0.0 GB (ìºì‹œë¨)
ğŸ“ ê°„ë‹¨í•œ ë¹„ë””ì˜¤ ë°ì´í„°ì…‹ ì¤€ë¹„ ì¤‘...
ğŸ“ ê°„ë‹¨í•œ ë°ì´í„°ë¡œë” ìƒì„± ì¤‘...
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_0.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_1.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_2.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_3.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_4.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_5.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_6.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_7.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_8.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_9.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_10.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_11.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_12.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_13.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_14.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_15.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_16.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_17.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_18.avi (1000 í”„ë ˆì„)
âœ… ë¹„ë””ì˜¤ ë¡œë“œ: normal_19.avi (478 í”„ë ˆì„)
âœ… 20ê°œ ë¹„ë””ì˜¤ ë¡œë“œ ì™„ë£Œ
ğŸ“ ê°„ë‹¨í•œ ë¹„ë””ì˜¤ ë°ì´í„°ì…‹ ì¤€ë¹„ ì¤‘...
ğŸ“Š ë¹„ë””ì˜¤ 1: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_0.avi -> video_01.mp4
ğŸ“Š ë¹„ë””ì˜¤ 2: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_1.avi -> video_02.mp4
ğŸ“Š ë¹„ë””ì˜¤ 3: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_2.avi -> video_03.mp4
ğŸ“Š ë¹„ë””ì˜¤ 4: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_3.avi -> video_04.mp4
ğŸ“Š ë¹„ë””ì˜¤ 5: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_4.avi -> video_05.mp4
ğŸ“Š ë¹„ë””ì˜¤ 6: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_5.avi -> video_06.mp4
ğŸ“Š ë¹„ë””ì˜¤ 7: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_6.avi -> video_07.mp4
ğŸ“Š ë¹„ë””ì˜¤ 8: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_7.avi -> video_08.mp4
ğŸ“Š ë¹„ë””ì˜¤ 9: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_8.avi -> video_09.mp4
ğŸ“Š ë¹„ë””ì˜¤ 10: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_9.avi -> video_10.mp4
ğŸ“Š ë¹„ë””ì˜¤ 11: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_10.avi -> video_11.mp4
ğŸ“Š ë¹„ë””ì˜¤ 12: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_11.avi -> video_12.mp4
ğŸ“Š ë¹„ë””ì˜¤ 13: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_12.avi -> video_13.mp4
ğŸ“Š ë¹„ë””ì˜¤ 14: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_13.avi -> video_14.mp4
ğŸ“Š ë¹„ë””ì˜¤ 15: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_14.avi -> video_15.mp4
ğŸ“Š ë¹„ë””ì˜¤ 16: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_15.avi -> video_16.mp4
ğŸ“Š ë¹„ë””ì˜¤ 17: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_16.avi -> video_17.mp4
ğŸ“Š ë¹„ë””ì˜¤ 18: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_17.avi -> video_18.mp4
ğŸ“Š ë¹„ë””ì˜¤ 19: 1000 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_18.avi -> video_19.mp4
ğŸ“Š ë¹„ë””ì˜¤ 20: 478 í”„ë ˆì„
âœ… ë³µì‚¬ ì™„ë£Œ: normal_19.avi -> video_20.mp4
âœ… ê°„ë‹¨í•œ ë¹„ë””ì˜¤ ë°ì´í„°ì…‹ ì¤€ë¹„ ì™„ë£Œ: 20ê°œ íŒŒì¼
ğŸ¤– AI-VAD ëª¨ë¸ ì´ˆê¸°í™”...
âœ… ëª¨ë¸ ì´ˆê¸°í™” ì™„ë£Œ
âš™ï¸  ê°„ë‹¨í•œ í•™ìŠµ ì„¤ì •...
ğŸš€ GPU ê°€ì† í•™ìŠµ ì—”ì§„ ì„¤ì •...
âœ… ê°„ë‹¨í•œ í•™ìŠµ ì—”ì§„ ì„¤ì • ì™„ë£Œ
ğŸ¯ ê°„ë‹¨í•œ í•™ìŠµ ì‹œì‘!
âš ï¸  ë°ì´í„° ëª¨ë“ˆ ì—†ì´ ê¸°ë³¸ ëª¨ë¸ í•™ìŠµì„ ì‹œë„í•©ë‹ˆë‹¤...
âŒ í•™ìŠµ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: The size of tensor a (4) must match the size of tensor b (3) at non-singleton dimension 0
Traceback (most recent call last):
  File "C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib\train_custom_final_fixed.py", line 304, in main
    output = model(dummy_data)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\models\components\base\anomalib_module.py", line 200, in forward
    batch = self.model(batch)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\models\video\ai_vad\torch_model.py", line 192, in forward
    flows = self.flow_extractor(first_frame, last_frame)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\models\video\ai_vad\flow.py", line 71, in forward
    first_frame, last_frame = self.pre_process(first_frame, last_frame)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\models\video\ai_vad\flow.py", line 56, in pre_process
    return self.transforms(first_frame, last_frame)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torchvision\transforms\_presets.py", line 201, in forward
    img1 = F.normalize(img1, mean=[0.5, 0.5, 0.5], std=[0.5, 0.5, 0.5])
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torchvision\transforms\functional.py", line 350, in normalize
    return F_t.normalize(tensor, mean=mean, std=std, inplace=inplace)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torchvision\transforms\_functional_tensor.py", line 928, in normalize
    return tensor.sub_(mean).div_(std)
RuntimeError: The size of tensor a (4) must match the size of tensor b (3) at non-singleton dimension 0

ğŸ’¥ í•™ìŠµì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.

--- ISSUE : ---
(mt_p310) C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib>python train_aivad_working.py
ğŸ”§ GPU ë° cuDNN ì„¤ì • ìµœì í™” ì¤‘...
âœ… GPU ì‚¬ìš© ê°€ëŠ¥: NVIDIA GeForce RTX 4090
âœ… GPU ë©”ëª¨ë¦¬: 24.0 GB
============================================================
ğŸ† ì‘ë™í•˜ëŠ” AI-VAD ëª¨ë¸ í•™ìŠµ (Tensor í¬ê¸° ë¬¸ì œ í•´ê²°)
============================================================
ğŸš€ ì‘ë™í•˜ëŠ” AI-VAD ëª¨ë¸ í•™ìŠµ ì‹œì‘...
ğŸ¯ ì‚¬ìš© ë””ë°”ì´ìŠ¤: cuda
ğŸ“Š GPU ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: 0.000 GB (í• ë‹¹ë¨), 0.000 GB (ìºì‹œë¨)
ğŸ¤– AI-VAD ëª¨ë¸ ì´ˆê¸°í™”...
âœ… ëª¨ë¸ ì´ˆê¸°í™” ì™„ë£Œ
âœ… ëª¨ë¸ì„ GPUë¡œ ì´ë™ ì™„ë£Œ
ğŸ“Š ëª¨ë¸ ë¡œë“œ í›„ GPU ë©”ëª¨ë¦¬: 0.755 GB (í• ë‹¹ë¨), 0.766 GB (ìºì‹œë¨)

ğŸ” ëª¨ë¸ ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸...
ğŸ” ëª¨ë¸ ì»´í¬ë„ŒíŠ¸ë³„ í…ŒìŠ¤íŠ¸ ì¤‘...
ğŸ” Flow extractor í…ŒìŠ¤íŠ¸...
âœ… Flow extractor ì„±ê³µ: torch.Size([1, 2, 224, 224])

ğŸ§ª ëª¨ë¸ forward pass í…ŒìŠ¤íŠ¸...
ğŸ§ª ëª¨ë¸ forward pass í…ŒìŠ¤íŠ¸ ì¤‘...
ğŸ“Š AI-VADìš© ì •í™•í•œ ë¹„ë””ì˜¤ ë°°ì¹˜ ìƒì„± ì¤‘...
âœ… ë¹„ë””ì˜¤ ë°°ì¹˜ ìƒì„± ì™„ë£Œ: torch.Size([2, 2, 3, 224, 224])
   - ë°°ì¹˜ í¬ê¸°: 2
   - í”„ë ˆì„ ìˆ˜: 2
   - ì±„ë„ ìˆ˜: 3 (RGB)
   - í•´ìƒë„: 224x224
âœ… ë¹„ë””ì˜¤ ë°°ì¹˜ë¥¼ GPUë¡œ ì´ë™ ì™„ë£Œ
âŒ Forward pass ì‹¤íŒ¨: 'list' object has no attribute 'pred_score'
Traceback (most recent call last):
  File "C:\Users\User\PycharmProjects\pythonProject1\mt_via_anomalib\mt_via_anomalib\train_aivad_working.py", line 70, in test_model_forward_pass
    output = model(video_batch)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\models\components\base\anomalib_module.py", line 201, in forward
    return self.post_processor(batch) if self.post_processor else batch
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\torch\nn\modules\module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\User\anaconda3\envs\mt_p310\lib\site-packages\anomalib\post_processing\post_processor.py", line 210, in forward
    if predictions.pred_score is None and predictions.anomaly_map is None:
AttributeError: 'list' object has no attribute 'pred_score'

âŒ ì¼ë¶€ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨

ğŸ’¥ ëª¨ë¸ í…ŒìŠ¤íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.

ğŸ“‹ í•´ê²° ë°©ë²•:
1. GPU ë“œë¼ì´ë²„ ë° CUDA ì„¤ì¹˜ í™•ì¸
2. PyTorch GPU ë²„ì „ ì„¤ì¹˜ í™•ì¸
3. ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰